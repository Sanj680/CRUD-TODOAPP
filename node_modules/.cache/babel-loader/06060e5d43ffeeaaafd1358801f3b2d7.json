{"ast":null,"code":"import _slicedToArray from \"C:\\\\Users\\\\sanja\\\\Downloads\\\\todo-react-main\\\\todo-react-main\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport React, { useEffect, useRef } from 'react';\nimport useMutationObserver from './useMutationObserver';\nimport { getStyleStr, getPixelRatio, rotateWatermark } from './utils';\n/**\n * Base size of the canvas, 1 for parallel layout and 2 for alternate layout\n * Only alternate layout is currently supported\n */\n\nvar BaseSize = 2;\nvar FontGap = 3;\n\nvar Watermark = function Watermark(props) {\n  var _a, _b;\n\n  var _props$zIndex = props.zIndex,\n      zIndex = _props$zIndex === void 0 ? 9 : _props$zIndex,\n      _props$rotate = props.rotate,\n      rotate = _props$rotate === void 0 ? -22 : _props$rotate,\n      width = props.width,\n      height = props.height,\n      image = props.image,\n      content = props.content,\n      _props$font = props.font,\n      font = _props$font === void 0 ? {} : _props$font,\n      style = props.style,\n      className = props.className,\n      _props$gap = props.gap,\n      gap = _props$gap === void 0 ? [100, 100] : _props$gap,\n      offset = props.offset,\n      children = props.children;\n  var _font$color = font.color,\n      color = _font$color === void 0 ? 'rgba(0,0,0,.15)' : _font$color,\n      _font$fontSize = font.fontSize,\n      fontSize = _font$fontSize === void 0 ? 16 : _font$fontSize,\n      _font$fontWeight = font.fontWeight,\n      fontWeight = _font$fontWeight === void 0 ? 'normal' : _font$fontWeight,\n      _font$fontStyle = font.fontStyle,\n      fontStyle = _font$fontStyle === void 0 ? 'normal' : _font$fontStyle,\n      _font$fontFamily = font.fontFamily,\n      fontFamily = _font$fontFamily === void 0 ? 'sans-serif' : _font$fontFamily;\n\n  var _gap = _slicedToArray(gap, 2),\n      gapX = _gap[0],\n      gapY = _gap[1];\n\n  var gapXCenter = gapX / 2;\n  var gapYCenter = gapY / 2;\n  var offsetLeft = (_a = offset === null || offset === void 0 ? void 0 : offset[0]) !== null && _a !== void 0 ? _a : gapXCenter;\n  var offsetTop = (_b = offset === null || offset === void 0 ? void 0 : offset[1]) !== null && _b !== void 0 ? _b : gapYCenter;\n\n  var getMarkStyle = function getMarkStyle() {\n    var markStyle = {\n      zIndex: zIndex,\n      position: 'absolute',\n      left: 0,\n      top: 0,\n      width: '100%',\n      height: '100%',\n      pointerEvents: 'none',\n      backgroundRepeat: 'repeat'\n    };\n    /** Calculate the style of the offset */\n\n    var positionLeft = offsetLeft - gapXCenter;\n    var positionTop = offsetTop - gapYCenter;\n\n    if (positionLeft > 0) {\n      markStyle.left = \"\".concat(positionLeft, \"px\");\n      markStyle.width = \"calc(100% - \".concat(positionLeft, \"px)\");\n      positionLeft = 0;\n    }\n\n    if (positionTop > 0) {\n      markStyle.top = \"\".concat(positionTop, \"px\");\n      markStyle.height = \"calc(100% - \".concat(positionTop, \"px)\");\n      positionTop = 0;\n    }\n\n    markStyle.backgroundPosition = \"\".concat(positionLeft, \"px \").concat(positionTop, \"px\");\n    return markStyle;\n  };\n\n  var containerRef = useRef(null);\n  var watermarkRef = useRef();\n\n  var _useMutationObserver = useMutationObserver(),\n      createObserver = _useMutationObserver.createObserver,\n      destroyObserver = _useMutationObserver.destroyObserver,\n      reRendering = _useMutationObserver.reRendering;\n\n  var destroyWatermark = function destroyWatermark() {\n    if (watermarkRef.current) {\n      watermarkRef.current.remove();\n      watermarkRef.current = undefined;\n    }\n  };\n\n  var appendWatermark = function appendWatermark(base64Url, markWidth) {\n    var _a;\n\n    if (containerRef.current && watermarkRef.current) {\n      destroyObserver();\n      watermarkRef.current.setAttribute('style', getStyleStr(Object.assign(Object.assign({}, getMarkStyle()), {\n        backgroundImage: \"url('\".concat(base64Url, \"')\"),\n        backgroundSize: \"\".concat((gapX + markWidth) * BaseSize, \"px\")\n      })));\n      (_a = containerRef.current) === null || _a === void 0 ? void 0 : _a.append(watermarkRef.current);\n      createObserver(containerRef.current, function (mutations) {\n        mutations.forEach(function (mutation) {\n          if (reRendering(mutation, watermarkRef.current)) {\n            destroyWatermark(); // eslint-disable-next-line @typescript-eslint/no-use-before-define\n\n            renderWatermark();\n          }\n        });\n      });\n    }\n  };\n  /**\n   * Get the width and height of the watermark. The default values are as follows\n   * Image: [120, 64]; Content: It's calculated by content;\n   */\n\n\n  var getMarkSize = function getMarkSize(ctx) {\n    var defaultWidth = 120;\n    var defaultHeight = 64;\n\n    if (!image && ctx.measureText) {\n      ctx.font = \"\".concat(Number(fontSize), \"px \").concat(fontFamily);\n      var contents = Array.isArray(content) ? content : [content];\n      var widths = contents.map(function (item) {\n        return ctx.measureText(item).width;\n      });\n      defaultWidth = Math.ceil(Math.max.apply(Math, _toConsumableArray(widths)));\n      defaultHeight = Number(fontSize) * contents.length + (contents.length - 1) * FontGap;\n    }\n\n    return [width !== null && width !== void 0 ? width : defaultWidth, height !== null && height !== void 0 ? height : defaultHeight];\n  };\n\n  var fillTexts = function fillTexts(ctx, drawX, drawY, drawWidth, drawHeight) {\n    var ratio = getPixelRatio();\n    var mergedFontSize = Number(fontSize) * ratio;\n    ctx.font = \"\".concat(fontStyle, \" normal \").concat(fontWeight, \" \").concat(mergedFontSize, \"px/\").concat(drawHeight, \"px \").concat(fontFamily);\n    ctx.fillStyle = color;\n    ctx.textAlign = 'center';\n    ctx.textBaseline = 'top';\n    ctx.translate(drawWidth / 2, 0);\n    var contents = Array.isArray(content) ? content : [content];\n    contents === null || contents === void 0 ? void 0 : contents.forEach(function (item, index) {\n      ctx.fillText(item !== null && item !== void 0 ? item : '', drawX, drawY + index * (mergedFontSize + FontGap * ratio));\n    });\n  };\n\n  var renderWatermark = function renderWatermark() {\n    var canvas = document.createElement('canvas');\n    var ctx = canvas.getContext('2d');\n\n    if (ctx) {\n      if (!watermarkRef.current) {\n        watermarkRef.current = document.createElement('div');\n      }\n\n      var ratio = getPixelRatio();\n\n      var _getMarkSize = getMarkSize(ctx),\n          _getMarkSize2 = _slicedToArray(_getMarkSize, 2),\n          markWidth = _getMarkSize2[0],\n          markHeight = _getMarkSize2[1];\n\n      var canvasWidth = (gapX + markWidth) * ratio;\n      var canvasHeight = (gapY + markHeight) * ratio;\n      canvas.setAttribute('width', \"\".concat(canvasWidth * BaseSize, \"px\"));\n      canvas.setAttribute('height', \"\".concat(canvasHeight * BaseSize, \"px\"));\n      var drawX = gapX * ratio / 2;\n      var drawY = gapY * ratio / 2;\n      var drawWidth = markWidth * ratio;\n      var drawHeight = markHeight * ratio;\n      var rotateX = (drawWidth + gapX * ratio) / 2;\n      var rotateY = (drawHeight + gapY * ratio) / 2;\n      /** Alternate drawing parameters */\n\n      var alternateDrawX = drawX + canvasWidth;\n      var alternateDrawY = drawY + canvasHeight;\n      var alternateRotateX = rotateX + canvasWidth;\n      var alternateRotateY = rotateY + canvasHeight;\n      ctx.save();\n      rotateWatermark(ctx, rotateX, rotateY, rotate);\n\n      if (image) {\n        var img = new Image();\n\n        img.onload = function () {\n          ctx.drawImage(img, drawX, drawY, drawWidth, drawHeight);\n          /** Draw interleaved pictures after rotation */\n\n          ctx.restore();\n          rotateWatermark(ctx, alternateRotateX, alternateRotateY, rotate);\n          ctx.drawImage(img, alternateDrawX, alternateDrawY, drawWidth, drawHeight);\n          appendWatermark(canvas.toDataURL(), markWidth);\n        };\n\n        img.crossOrigin = 'anonymous';\n        img.referrerPolicy = 'no-referrer';\n        img.src = image;\n      } else {\n        fillTexts(ctx, drawX, drawY, drawWidth, drawHeight);\n        /** Fill the interleaved text after rotation */\n\n        ctx.restore();\n        rotateWatermark(ctx, alternateRotateX, alternateRotateY, rotate);\n        fillTexts(ctx, alternateDrawX, alternateDrawY, drawWidth, drawHeight);\n        appendWatermark(canvas.toDataURL(), markWidth);\n      }\n    }\n  };\n\n  useEffect(renderWatermark, [rotate, zIndex, width, height, image, content, color, fontSize, fontWeight, fontStyle, fontFamily, gapX, gapY, offsetLeft, offsetTop]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    ref: containerRef,\n    className: className,\n    style: Object.assign({\n      position: 'relative'\n    }, style)\n  }, children);\n};\n\nexport default Watermark;","map":{"version":3,"sources":["C:/Users/sanja/Downloads/todo-react-main/todo-react-main/node_modules/antd/es/watermark/index.js"],"names":["_toConsumableArray","React","useEffect","useRef","useMutationObserver","getStyleStr","getPixelRatio","rotateWatermark","BaseSize","FontGap","Watermark","props","_a","_b","zIndex","rotate","width","height","image","content","font","style","className","gap","offset","children","color","fontSize","fontWeight","fontStyle","fontFamily","gapX","gapY","gapXCenter","gapYCenter","offsetLeft","offsetTop","getMarkStyle","markStyle","position","left","top","pointerEvents","backgroundRepeat","positionLeft","positionTop","backgroundPosition","containerRef","watermarkRef","createObserver","destroyObserver","reRendering","destroyWatermark","current","remove","undefined","appendWatermark","base64Url","markWidth","setAttribute","Object","assign","backgroundImage","backgroundSize","append","mutations","forEach","mutation","renderWatermark","getMarkSize","ctx","defaultWidth","defaultHeight","measureText","Number","contents","Array","isArray","widths","map","item","Math","ceil","max","apply","length","fillTexts","drawX","drawY","drawWidth","drawHeight","ratio","mergedFontSize","fillStyle","textAlign","textBaseline","translate","index","fillText","canvas","document","createElement","getContext","markHeight","canvasWidth","canvasHeight","rotateX","rotateY","alternateDrawX","alternateDrawY","alternateRotateX","alternateRotateY","save","img","Image","onload","drawImage","restore","toDataURL","crossOrigin","referrerPolicy","src","ref"],"mappings":"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","sourcesContent":["import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport React, { useEffect, useRef } from 'react';\nimport useMutationObserver from './useMutationObserver';\nimport { getStyleStr, getPixelRatio, rotateWatermark } from './utils';\n/**\n * Base size of the canvas, 1 for parallel layout and 2 for alternate layout\n * Only alternate layout is currently supported\n */\nconst BaseSize = 2;\nconst FontGap = 3;\nconst Watermark = props => {\n  var _a, _b;\n  const {\n    /**\n     * The antd content layer zIndex is basically below 10\n     * https://github.com/ant-design/ant-design/blob/6192403b2ce517c017f9e58a32d58774921c10cd/components/style/themes/default.less#L335\n     */\n    zIndex = 9,\n    rotate = -22,\n    width,\n    height,\n    image,\n    content,\n    font = {},\n    style,\n    className,\n    gap = [100, 100],\n    offset,\n    children\n  } = props;\n  const {\n    color = 'rgba(0,0,0,.15)',\n    fontSize = 16,\n    fontWeight = 'normal',\n    fontStyle = 'normal',\n    fontFamily = 'sans-serif'\n  } = font;\n  const [gapX, gapY] = gap;\n  const gapXCenter = gapX / 2;\n  const gapYCenter = gapY / 2;\n  const offsetLeft = (_a = offset === null || offset === void 0 ? void 0 : offset[0]) !== null && _a !== void 0 ? _a : gapXCenter;\n  const offsetTop = (_b = offset === null || offset === void 0 ? void 0 : offset[1]) !== null && _b !== void 0 ? _b : gapYCenter;\n  const getMarkStyle = () => {\n    const markStyle = {\n      zIndex,\n      position: 'absolute',\n      left: 0,\n      top: 0,\n      width: '100%',\n      height: '100%',\n      pointerEvents: 'none',\n      backgroundRepeat: 'repeat'\n    };\n    /** Calculate the style of the offset */\n    let positionLeft = offsetLeft - gapXCenter;\n    let positionTop = offsetTop - gapYCenter;\n    if (positionLeft > 0) {\n      markStyle.left = `${positionLeft}px`;\n      markStyle.width = `calc(100% - ${positionLeft}px)`;\n      positionLeft = 0;\n    }\n    if (positionTop > 0) {\n      markStyle.top = `${positionTop}px`;\n      markStyle.height = `calc(100% - ${positionTop}px)`;\n      positionTop = 0;\n    }\n    markStyle.backgroundPosition = `${positionLeft}px ${positionTop}px`;\n    return markStyle;\n  };\n  const containerRef = useRef(null);\n  const watermarkRef = useRef();\n  const {\n    createObserver,\n    destroyObserver,\n    reRendering\n  } = useMutationObserver();\n  const destroyWatermark = () => {\n    if (watermarkRef.current) {\n      watermarkRef.current.remove();\n      watermarkRef.current = undefined;\n    }\n  };\n  const appendWatermark = (base64Url, markWidth) => {\n    var _a;\n    if (containerRef.current && watermarkRef.current) {\n      destroyObserver();\n      watermarkRef.current.setAttribute('style', getStyleStr(Object.assign(Object.assign({}, getMarkStyle()), {\n        backgroundImage: `url('${base64Url}')`,\n        backgroundSize: `${(gapX + markWidth) * BaseSize}px`\n      })));\n      (_a = containerRef.current) === null || _a === void 0 ? void 0 : _a.append(watermarkRef.current);\n      createObserver(containerRef.current, mutations => {\n        mutations.forEach(mutation => {\n          if (reRendering(mutation, watermarkRef.current)) {\n            destroyWatermark();\n            // eslint-disable-next-line @typescript-eslint/no-use-before-define\n            renderWatermark();\n          }\n        });\n      });\n    }\n  };\n  /**\n   * Get the width and height of the watermark. The default values are as follows\n   * Image: [120, 64]; Content: It's calculated by content;\n   */\n  const getMarkSize = ctx => {\n    let defaultWidth = 120;\n    let defaultHeight = 64;\n    if (!image && ctx.measureText) {\n      ctx.font = `${Number(fontSize)}px ${fontFamily}`;\n      const contents = Array.isArray(content) ? content : [content];\n      const widths = contents.map(item => ctx.measureText(item).width);\n      defaultWidth = Math.ceil(Math.max.apply(Math, _toConsumableArray(widths)));\n      defaultHeight = Number(fontSize) * contents.length + (contents.length - 1) * FontGap;\n    }\n    return [width !== null && width !== void 0 ? width : defaultWidth, height !== null && height !== void 0 ? height : defaultHeight];\n  };\n  const fillTexts = (ctx, drawX, drawY, drawWidth, drawHeight) => {\n    const ratio = getPixelRatio();\n    const mergedFontSize = Number(fontSize) * ratio;\n    ctx.font = `${fontStyle} normal ${fontWeight} ${mergedFontSize}px/${drawHeight}px ${fontFamily}`;\n    ctx.fillStyle = color;\n    ctx.textAlign = 'center';\n    ctx.textBaseline = 'top';\n    ctx.translate(drawWidth / 2, 0);\n    const contents = Array.isArray(content) ? content : [content];\n    contents === null || contents === void 0 ? void 0 : contents.forEach((item, index) => {\n      ctx.fillText(item !== null && item !== void 0 ? item : '', drawX, drawY + index * (mergedFontSize + FontGap * ratio));\n    });\n  };\n  const renderWatermark = () => {\n    const canvas = document.createElement('canvas');\n    const ctx = canvas.getContext('2d');\n    if (ctx) {\n      if (!watermarkRef.current) {\n        watermarkRef.current = document.createElement('div');\n      }\n      const ratio = getPixelRatio();\n      const [markWidth, markHeight] = getMarkSize(ctx);\n      const canvasWidth = (gapX + markWidth) * ratio;\n      const canvasHeight = (gapY + markHeight) * ratio;\n      canvas.setAttribute('width', `${canvasWidth * BaseSize}px`);\n      canvas.setAttribute('height', `${canvasHeight * BaseSize}px`);\n      const drawX = gapX * ratio / 2;\n      const drawY = gapY * ratio / 2;\n      const drawWidth = markWidth * ratio;\n      const drawHeight = markHeight * ratio;\n      const rotateX = (drawWidth + gapX * ratio) / 2;\n      const rotateY = (drawHeight + gapY * ratio) / 2;\n      /** Alternate drawing parameters */\n      const alternateDrawX = drawX + canvasWidth;\n      const alternateDrawY = drawY + canvasHeight;\n      const alternateRotateX = rotateX + canvasWidth;\n      const alternateRotateY = rotateY + canvasHeight;\n      ctx.save();\n      rotateWatermark(ctx, rotateX, rotateY, rotate);\n      if (image) {\n        const img = new Image();\n        img.onload = () => {\n          ctx.drawImage(img, drawX, drawY, drawWidth, drawHeight);\n          /** Draw interleaved pictures after rotation */\n          ctx.restore();\n          rotateWatermark(ctx, alternateRotateX, alternateRotateY, rotate);\n          ctx.drawImage(img, alternateDrawX, alternateDrawY, drawWidth, drawHeight);\n          appendWatermark(canvas.toDataURL(), markWidth);\n        };\n        img.crossOrigin = 'anonymous';\n        img.referrerPolicy = 'no-referrer';\n        img.src = image;\n      } else {\n        fillTexts(ctx, drawX, drawY, drawWidth, drawHeight);\n        /** Fill the interleaved text after rotation */\n        ctx.restore();\n        rotateWatermark(ctx, alternateRotateX, alternateRotateY, rotate);\n        fillTexts(ctx, alternateDrawX, alternateDrawY, drawWidth, drawHeight);\n        appendWatermark(canvas.toDataURL(), markWidth);\n      }\n    }\n  };\n  useEffect(renderWatermark, [rotate, zIndex, width, height, image, content, color, fontSize, fontWeight, fontStyle, fontFamily, gapX, gapY, offsetLeft, offsetTop]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    ref: containerRef,\n    className: className,\n    style: Object.assign({\n      position: 'relative'\n    }, style)\n  }, children);\n};\nexport default Watermark;"]},"metadata":{},"sourceType":"module"}